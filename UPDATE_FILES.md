# –Ø–∫ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

## –°–ø–æ—Å—ñ–± 1: –ß–µ—Ä–µ–∑ FileZilla (–ø—Ä–æ—Å—Ç–∏–π —Å–ø–æ—Å—ñ–±)

### –û–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö —Ñ–∞–π–ª—ñ–≤:

1. **–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ FileZilla**
2. **–ó–Ω–∞–π–¥—ñ—Ç—å —Ñ–∞–π–ª, —è–∫–∏–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏:**
   - –õ—ñ–≤–∞ —Å—Ç–æ—Ä–æ–Ω–∞: –≤–∞—à –∫–æ–º–ø'—é—Ç–µ—Ä –∑ –Ω–æ–≤–æ—é –≤–µ—Ä—Å—ñ—î—é —Ñ–∞–π–ª—É
   - –ü—Ä–∞–≤–∞ —Å—Ç–æ—Ä–æ–Ω–∞: —Å–µ—Ä–≤–µ—Ä –∑—ñ —Å—Ç–∞—Ä–æ—é –≤–µ—Ä—Å—ñ—î—é

3. **–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å –Ω–æ–≤–∏–π —Ñ–∞–π–ª:**
   - FileZilla –∑–∞–ø–∏—Ç–∞—î: "–§–∞–π–ª –≤–∂–µ —ñ—Å–Ω—É—î. –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏?"
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Yes" –∞–±–æ "Yes to all" (—è–∫—â–æ –æ–Ω–æ–≤–ª—é—î—Ç–µ –±–∞–≥–∞—Ç–æ —Ñ–∞–π–ª—ñ–≤)

4. **–ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è backend —Ñ–∞–π–ª—ñ–≤:**
   ```bash
   # –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ SSH –∞–±–æ –≤–µ–±-—Ç–µ—Ä–º—ñ–Ω–∞–ª
   cd /home/ergoa/affiliate-tracking
   pm2 restart affiliate-tracking-api
   ```

5. **–ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è frontend —Ñ–∞–π–ª—ñ–≤ (–û–ë–û–í'–Ø–ó–ö–û–í–û!):**
   ```bash
   cd /home/ergoa/affiliate-tracking/frontend
   
   # 1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ —î .env —Ñ–∞–π–ª –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º API URL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω—É:
   # –°—Ç–≤–æ—Ä—ñ—Ç—å –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞–π–ª frontend/.env:
   # VITE_API_URL=https://lehko.space
   # (–∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à –ø—Ä–æ–¥–∞–∫—à–Ω-URL API, –ù–ï localhost!)
   
   # 2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (—è–∫—â–æ —â–µ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ):
   npm install
   
   # 3. –ó–±—ñ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É (—Å—Ç–≤–æ—Ä—é—î –ø–∞–ø–∫—É dist/ –∑ –≥–æ—Ç–æ–≤–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏):
   npm run build
   
   # 4. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (nginx/apache) –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π 
   #    –≤—ñ–¥–¥–∞–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ –∑ –ø–∞–ø–∫–∏ frontend/dist/
   ```
   
   **‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:** –ü—Ä–æ—Å—Ç–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ù–ï –î–û–°–¢–ê–¢–ù–¨–û! 
   –ü–æ—Ç—Ä—ñ–±–Ω–æ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ `npm run build` –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, 
   —ñ–Ω–∞–∫—à–µ –∑–º—ñ–Ω–∏ –Ω–µ –∑'—è–≤–ª—è—Ç—å—Å—è –Ω–∞ —Å–∞–π—Ç—ñ.

### –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤ (–ø–æ–≤–Ω–∏–π –¥–µ–ø–ª–æ–π):

1. **–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –∞—Ä—Ö—ñ–≤ –∑ –æ–Ω–æ–≤–ª–µ–Ω–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏:**
   ```powershell
   cd C:\Users\ergoa\Downloads\affiliate-tracking-main\affiliate-tracking-main
   # –í–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞—Ä–∏–π –∞—Ä—Ö—ñ–≤
   Remove-Item ..\deploy.zip -ErrorAction SilentlyContinue
   # –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π
   Get-ChildItem -Exclude node_modules,.env,*.log,logs,.git,deploy.zip | Compress-Archive -DestinationPath ..\deploy.zip -Force
   ```

2. **–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–æ–≤–∏–π –∞—Ä—Ö—ñ–≤ —á–µ—Ä–µ–∑ FileZilla**

3. **–ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ:**
   ```bash
   cd /home/ergoa/affiliate-tracking
   # –ó—Ä–æ–±—ñ—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É –∫–æ–ø—ñ—é (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
   cp -r . ../affiliate-tracking-backup
   
   # –†–æ–∑–ø–∞–∫—É–π—Ç–µ –Ω–æ–≤–∏–π –∞—Ä—Ö—ñ–≤ –≤ —Ç–∏–º—á–∞—Å–æ–≤—É –ø–∞–ø–∫—É
   cd ..
   unzip deploy.zip -d affiliate-tracking-new
   
   # –°–∫–æ–ø—ñ—é–π—Ç–µ –Ω–æ–≤—ñ —Ñ–∞–π–ª–∏ (–∫—Ä—ñ–º node_modules —Ç–∞ .env)
   cp -r affiliate-tracking-new/* affiliate-tracking/
   cp -r affiliate-tracking-new/.* affiliate-tracking/ 2>/dev/null || true
   
   # –í–∏–¥–∞–ª—ñ—Ç—å —Ç–∏–º—á–∞—Å–æ–≤—É –ø–∞–ø–∫—É
   rm -rf affiliate-tracking-new
   
   # –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (—è–∫—â–æ –∑–º—ñ–Ω–∏–≤—Å—è package.json)
   cd affiliate-tracking
   npm install --production
   
   # –ü–µ—Ä–µ–±—ñ–ª–¥—ñ—Ç—å frontend
   cd frontend
   npm install
   npm run build
   cd ..
   
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä
   pm2 restart affiliate-tracking-api
   ```

---

## –°–ø–æ—Å—ñ–± 2: –ß–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å)
### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Git –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ:

1. **–°—Ç–≤–æ—Ä—ñ—Ç—å Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π** (GitHub, GitLab, Bitbucket)

2. **–ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ:**
   ```bash
   cd /home/ergoa
   
   # –Ø–∫—â–æ –ø—Ä–æ—î–∫—Ç —â–µ –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ Git
   cd affiliate-tracking
   git init
   git remote add origin https://github.com/your-username/your-repo.git
   git add .
   git commit -m "Initial commit"
   git push -u origin main
   
   # –Ø–∫—â–æ –ø—Ä–æ—î–∫—Ç –≤–∂–µ –≤ Git
   git clone https://github.com/your-username/your-repo.git affiliate-tracking
   cd affiliate-tracking
   ```

3. **–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:**
   ```bash
   nano update.sh
   ```

   **–í–º—ñ—Å—Ç update.sh:**
   ```bash
   #!/bin/bash
   echo "üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É..."
   
   # –û—Ç—Ä–∏–º–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ –∑–º—ñ–Ω–∏
   git pull origin main
   
   # –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (—è–∫—â–æ –∑–º—ñ–Ω–∏–≤—Å—è package.json)
   npm install --production
   
   # –ü–µ—Ä–µ–±—ñ–ª–¥—ñ—Ç—å frontend
   cd frontend
   npm install
   npm run build
   cd ..
   
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
   pm2 restart affiliate-tracking-api
   
   echo "‚úÖ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
   ```

   **–ü—ñ—Å–ª—è git pull ‚Äî —è–∫—â–æ –∑‚Äô—è–≤–∏–ª–∏—Å—å –ø–æ–º–∏–ª–∫–∏ –ë–î (Unknown column ...):**
   
   –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó. –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ **—É—Å—ñ** –ø–æ —á–µ—Ä–∑—ñ (–±–µ–∑–ø–µ—á–Ω–æ ‚Äî —Å–∫—Ä–∏–ø—Ç–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—å –≤–∂–µ —ñ—Å–Ω—É—é—á—ñ –∫–æ–ª–æ–Ω–∫–∏/—Ç–∞–±–ª–∏—Ü—ñ):
   ```bash
   cd ~/affiliate-tracking   # –∞–±–æ –≤–∞—à —à–ª—è—Ö –¥–æ –ø—Ä–æ—î–∫—Ç—É
   npm run db:add-websites
   npm run db:add-universal-tracker
   npm run db:add-click-id
   npm run db:add-event-type
   pm2 restart affiliate-tracking-api
   ```
   –Ø–∫—â–æ –±–∞—á–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –ø–æ–º–∏–ª–∫—É:
   - **"Unknown column 'conversion_urls'"** ‚Üí `npm run db:add-universal-tracker`
   - **"Unknown column 'event_type'"** ‚Üí `npm run db:add-event-type`
   - **"Unknown column 'purchase_button_selector'"** –∞–±–æ **"Unknown column 'click_id'"** ‚Üí `npm run db:add-click-id`

   ```bash
   chmod +x update.sh
   ```

4. **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É:**
   ```bash
   cd /home/ergoa/affiliate-tracking
   ./update.sh
   ```

### –õ–æ–∫–∞–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞:

1. **–í–Ω–µ—Å—ñ—Ç—å –∑–º—ñ–Ω–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ**
2. **–ó–∞–∫–æ–º—ñ—Ç—å—Ç–µ —Ç–∞ –∑–∞–ø—É—à—Ç–µ:**
   ```bash
   git add .
   git commit -m "–û–ø–∏—Å –∑–º—ñ–Ω"
   git push origin main
   ```

3. **–ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ –≤–∏–∫–æ–Ω–∞–π—Ç–µ:**
   ```bash
   ./update.sh
   ```

---

## –°–ø–æ—Å—ñ–± 3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

### –°—Ç–≤–æ—Ä—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:

**–ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ —Å—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `quick-update.sh`:**
```bash
#!/bin/bash
cd /home/ergoa/affiliate-tracking

# –û–Ω–æ–≤–∏—Ç–∏ backend –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
npm install --production

# –û–Ω–æ–≤–∏—Ç–∏ frontend
cd frontend
npm install
npm run build
cd ..

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
pm2 restart affiliate-tracking-api

echo "‚úÖ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
```

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**
```bash
chmod +x quick-update.sh
./quick-update.sh
```

---

## –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –ø—ñ—Å–ª—è –∑–º—ñ–Ω

### üÜï –û—Å—Ç–∞–Ω–Ω—ñ –∑–º—ñ–Ω–∏ (—Ç—Ä–µ–∫–µ—Ä v2 –∑ verification ping):

**–û–±–æ–≤'—è–∑–∫–æ–≤–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥:**

1. **`public/tracker-v2.js`** - –û–Ω–æ–≤–ª–µ–Ω–æ –∑ verification ping
   - –¢—Ä–µ–∫–µ—Ä —Ç–µ–ø–µ—Ä –Ω–∞–¥—Å–∏–ª–∞—î ping –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
   - –î–æ–¥–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é `sendVerificationPing()` –≤ –ø—É–±–ª—ñ—á–Ω–∏–π API

2. **`public/tracker-test.html`** - –ù–æ–≤–∏–π —Ñ–∞–π–ª (—Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞)
   - –î–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É —Ç—Ä–µ–∫–µ—Ä–∞
   - –î–æ—Å—Ç—É–ø–Ω–∞ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: `https://your-domain.com/tracker-test.html`

3. **`routes/track.js`** - –î–æ–¥–∞–Ω–æ endpoint `/api/track/test`
   - –ü–æ–≤–µ—Ä—Ç–∞—î –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å—Ç–∞—Ç—É—Å —Ç—Ä–µ–∫–µ—Ä–∞
   - –ü–µ—Ä–µ–≤—ñ—Ä—è—î verification ping –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω

4. **`frontend/src/pages/Setup.jsx`** - –ü–æ–∫—Ä–∞—â–µ–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
   - –î–æ–¥–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
   - –î–æ–¥–∞–Ω–æ –≥–∞—Ä–∞–Ω—Ç—ñ—ó —Ä–æ–±–æ—Ç–∏ —Ç—Ä–µ–∫–µ—Ä–∞
   - –î–æ–¥–∞–Ω–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É
   - –ü–æ–∫—Ä–∞—â–µ–Ω–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

**–ü—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:**
```bash
# –ü–µ—Ä–µ–±—ñ–ª–¥—ñ—Ç—å frontend
cd frontend && npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä
pm2 restart affiliate-tracking-api
```

### Backend –∑–º—ñ–Ω–∏ (server.js, routes, models):
- ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–æ–≤—ñ —Ñ–∞–π–ª–∏ —á–µ—Ä–µ–∑ FileZilla
- ‚úÖ –í–∏–∫–æ–Ω–∞–π—Ç–µ: `pm2 restart affiliate-tracking-api`

### Frontend –∑–º—ñ–Ω–∏ (React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏):
- ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–æ–≤—ñ —Ñ–∞–π–ª–∏ —á–µ—Ä–µ–∑ FileZilla
- ‚úÖ –í–∏–∫–æ–Ω–∞–π—Ç–µ: `cd frontend && npm run build`
- ‚úÖ –§–∞–π–ª–∏ –≤ `frontend/dist/` –±—É–¥—É—Ç—å –æ–Ω–æ–≤–ª–µ–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

### –ó–º—ñ–Ω–∏ –≤ package.json:
- ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–æ–≤–∏–π package.json
- ‚úÖ –í–∏–∫–æ–Ω–∞–π—Ç–µ: `npm install --production` (backend)
- ‚úÖ –í–∏–∫–æ–Ω–∞–π—Ç–µ: `cd frontend && npm install && npm run build` (frontend)
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å: `pm2 restart affiliate-tracking-api`

### –ó–º—ñ–Ω–∏ –≤ .env:
- ‚ö†Ô∏è **–ù–ï –∑–∞–≤–∞–Ω—Ç–∞–∂—É–π—Ç–µ .env —á–µ—Ä–µ–∑ FileZilla!**
- ‚úÖ –°—Ç–≤–æ—Ä—ñ—Ç—å .env –≤—Ä—É—á–Ω—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ —á–µ—Ä–µ–∑ SSH/—Ç–µ—Ä–º—ñ–Ω–∞–ª
- ‚úÖ –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –±–µ–∑–ø–µ—á–Ω–∏–π —Å–ø–æ—Å—ñ–± –ø–µ—Ä–µ–¥–∞—á—ñ

---

## –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π workflow

### –î–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å:

1. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Git:**
   - –õ–æ–∫–∞–ª—å–Ω–æ: –∑–º—ñ–Ω–∏ ‚Üí commit ‚Üí push
   - –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ: `git pull` ‚Üí `./update.sh`

2. **–î–ª—è —à–≤–∏–¥–∫–∏—Ö –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å:**
   - FileZilla: –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ñ–∞–π–ª
   - SSH: `pm2 restart affiliate-tracking-api` (–¥–ª—è backend)
   - SSH: `cd frontend && npm run build` (–¥–ª—è frontend)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ:

```
/home/ergoa/
‚îú‚îÄ‚îÄ affiliate-tracking/     # –û—Å–Ω–æ–≤–Ω–∏–π –ø—Ä–æ—î–∫—Ç
‚îÇ   ‚îú‚îÄ‚îÄ .env                # –ù–ï –∫–æ–º—ñ—Ç–∏—Ç–∏ –≤ Git!
‚îÇ   ‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .env            # –ù–ï –∫–æ–º—ñ—Ç–∏—Ç–∏ –≤ Git!
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dist/           # –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ (–Ω–µ –∫–æ–º—ñ—Ç–∏—Ç–∏)
‚îÇ   ‚îî‚îÄ‚îÄ node_modules/       # –ù–µ –∫–æ–º—ñ—Ç–∏—Ç–∏
‚îî‚îÄ‚îÄ affiliate-tracking-backup/  # –†–µ–∑–µ—Ä–≤–Ω–∞ –∫–æ–ø—ñ—è (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
```

---

## –ë–µ–∑–ø–µ–∫–∞

1. **–ó–∞–≤–∂–¥–∏ —Ä–æ–±—ñ—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É –∫–æ–ø—ñ—é –ø–µ—Ä–µ–¥ –≤–µ–ª–∏–∫–∏–º–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏:**
   ```bash
   cp -r /home/ergoa/affiliate-tracking /home/ergoa/affiliate-tracking-backup-$(date +%Y%m%d)
   ```

2. **–ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∑–º—ñ–Ω–∏ –ø–µ—Ä–µ–¥ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è–º:**
   ```bash
   # –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è, —â–æ –∑–º—ñ–Ω–∏–ª–æ—Å—è
   git diff
   # –ê–±–æ –¥–ª—è Git pull
   git fetch
   git diff HEAD origin/main
   ```

3. **–¢–µ—Å—Ç—É–π—Ç–µ –Ω–∞ staging —Å–µ—Ä–≤–µ—Ä—ñ** (—è–∫—â–æ –º–æ–∂–ª–∏–≤–æ) –ø–µ—Ä–µ–¥ production

---

## –®–≤–∏–¥–∫—ñ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

### –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—Ä–µ–∫–µ—Ä–∞ (–æ—Å—Ç–∞–Ω–Ω—ñ –∑–º—ñ–Ω–∏):
```bash
cd /home/ergoa/affiliate-tracking

# –ü–µ—Ä–µ–±—ñ–ª–¥—ñ—Ç—å frontend (–ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è Setup.jsx)
cd frontend && npm run build && cd ..

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä (–ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è routes/track.js)
pm2 restart affiliate-tracking-api
```

### –¢—ñ–ª—å–∫–∏ backend:
```bash
cd /home/ergoa/affiliate-tracking
pm2 restart affiliate-tracking-api
```

### –¢—ñ–ª—å–∫–∏ frontend:
```bash
cd /home/ergoa/affiliate-tracking/frontend
npm run build
```

### –í—Å–µ —Ä–∞–∑–æ–º:
```bash
cd /home/ergoa/affiliate-tracking
npm install --production
cd frontend && npm install && npm run build && cd ..
pm2 restart affiliate-tracking-api
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—Ä–µ–∫–µ—Ä–∞ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥—É

### –ö—Ä–æ–∫ 1: –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª–∏ —á–µ—Ä–µ–∑ FileZilla
- [ ] `public/tracker-v2.js` (–æ–Ω–æ–≤–ª–µ–Ω–æ)
- [ ] `public/tracker-test.html` (–Ω–æ–≤–∏–π —Ñ–∞–π–ª)
- [ ] `routes/track.js` (–¥–æ–¥–∞–Ω–æ /test endpoint)
- [ ] `frontend/src/pages/Setup.jsx` (–ø–æ–∫—Ä–∞—â–µ–Ω–æ UI)

### –ö—Ä–æ–∫ 2: –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ —á–µ—Ä–µ–∑ SSH
```bash
cd /home/ergoa/affiliate-tracking

# –ü–µ—Ä–µ–±—ñ–ª–¥—ñ—Ç—å frontend
cd frontend && npm run build && cd ..

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤–µ—Ä
pm2 restart affiliate-tracking-api
```

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–±–æ—Ç—É
- [ ] –í—ñ–¥–∫—Ä–∏–π—Ç–µ `https://your-domain.com/tracker-test.html`
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ Setup ‚Üí "–ú–æ—ó —Å–∞–π—Ç–∏"
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: `pm2 logs affiliate-tracking-api`

---

## üöÄ –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è: –î–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É (—è–∫—â–æ —Å–∞–π—Ç –Ω–µ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è)

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "–í–∫–ª–∞–¥–∫–∏ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥—É —ñ–Ω—à—ñ –Ω—ñ–∂ –ª–æ–∫–∞–ª—å–Ω–æ" (—Å—Ç–∞—Ä–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

**–°–∏–º–ø—Ç–æ–º–∏:** –ù–∞ —Ö–æ—Å—Ç–∏–Ω–≥—É –±–∞—á–∏—Ç–µ "–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥–æ–º", "–î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è", –∞ –ª–æ–∫–∞–ª—å–Ω–æ ‚Äî "–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è", "–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î". –ù–∞–≤—ñ—Ç—å –ø—ñ—Å–ª—è `npm run build` –∑–º—ñ–Ω–∏ –Ω–µ –∑'—è–≤–ª—è—é—Ç—å—Å—è.

**–ü—Ä–∏—á–∏–Ω–∏:**
1. **–í–µ–±-—Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–¥–∞—î –Ω–µ —Ç—É –ø–∞–ø–∫—É** ‚Äî root –≤ nginx/apache –≤–∫–∞–∑—É—î –Ω–µ –Ω–∞ `frontend/dist/`, –∞ –Ω–∞ `frontend/` –∞–±–æ —ñ–Ω—à–∏–π –∫–∞—Ç–∞–ª–æ–≥.
2. **–ë—ñ–ª–¥ –∑—Ä–æ–±–ª–µ–Ω–æ –Ω–µ —Ç–∞–º** ‚Äî –∑–±—ñ—Ä–∫–∞ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∞—Å—å —É —ñ–Ω—à—ñ–π –∫–æ–ø—ñ—ó –ø—Ä–æ—î–∫—Ç—É –∞–±–æ –ª–æ–∫–∞–ª—å–Ω–æ, –∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–ª–∏–ª–∏ —Å—Ç–∞—Ä—ñ —Ñ–∞–π–ª–∏.
3. **–ö–µ—à** ‚Äî –±—Ä–∞—É–∑–µ—Ä –∞–±–æ CDN –≤—ñ–¥–¥–∞—î —Å—Ç–∞—Ä—ñ JS/CSS.

**–©–æ –∑—Ä–æ–±–∏—Ç–∏:**

1. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ root —É nginx (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ –º–∞—î –±—É—Ç–∏ `dist`):**
   ```bash
   sudo cat /etc/nginx/sites-enabled/–≤–∞—à-—Å–∞–π—Ç
   # –®—É–∫–∞–π—Ç–µ —Ä—è–¥–æ–∫ root ...; –º–∞—î –±—É—Ç–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç:
   # root /home/ergoa/affiliate-tracking/frontend/dist;
   # –ù–ï: root /home/ergoa/affiliate-tracking/frontend;
   ```
   –Ø–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ `frontend` –±–µ–∑ `dist` ‚Äî –≤–∏–ø—Ä–∞–≤—Ç–µ –Ω–∞ `frontend/dist`, –ø–æ—Ç—ñ–º:
   ```bash
   sudo nginx -t && sudo systemctl reload nginx
   ```

2. **–ó–±–∏—Ä–∞—Ç–∏ –±—ñ–ª–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –≤ —Ç–æ–º—É –∂ –ø—Ä–æ—î–∫—Ç—ñ, –∑ —è–∫–æ–≥–æ –≤—ñ–¥–¥–∞—î nginx:**
   ```bash
   cd ~/affiliate-tracking/frontend
   npm install
   npm run build
   ls -la dist/
   # –ú–∞—é—Ç—å –∑'—è–≤–∏—Ç–∏—Å—å index.html —Ç–∞ assets/*.js, *.css
   ```

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —è–∫–∏–π –±—ñ–ª–¥ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è:** –£ —Å–∞–π–¥–±–∞—Ä—ñ –≤–Ω–∏–∑—É (–ø—ñ–¥ Logout) —Ç–µ–ø–µ—Ä –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è **Build: 1234567890123**. –ü—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ `npm run build` —á–∏—Å–ª–æ –∑–º—ñ–Ω—é—î—Ç—å—Å—è. –Ø–∫—â–æ –ø—ñ—Å–ª—è –∑–±—ñ—Ä–∫–∏ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥—É —á–∏—Å–ª–æ —Ç–µ —Å–∞–º–µ, —â–æ –±—É–ª–æ ‚Äî –≤—ñ–¥–¥–∞—î—Ç—å—Å—è —Å—Ç–∞—Ä–∏–π –∫–µ—à –∞–±–æ –Ω–µ —Ç–∞ –ø–∞–ø–∫–∞.

4. **–ñ–æ—Ä—Å—Ç–∫–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ –±—Ä–∞—É–∑–µ—Ä—ñ:** `Ctrl+Shift+R` (Windows/Linux) –∞–±–æ `Cmd+Shift+R` (Mac), –∞–±–æ DevTools ‚Üí Network ‚Üí "Disable cache" ‚Üí –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É.

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏–≤ —Ñ–∞–π–ª–∏, –∞–ª–µ —Å–∞–π—Ç –Ω–µ –∑–º—ñ–Ω–∏–≤—Å—è"

**–ü—Ä–∏—á–∏–Ω–∞:** –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞ Vite –ø–æ—Ç—Ä–µ–±—É—î –∑–±—ñ—Ä–∫–∏ (`npm run build`). –ü—Ä–æ—Å—Ç–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏—Ö—ñ–¥–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ ‚Äî –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≥–æ—Ç–æ–≤—ñ —Å—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ –≤ –ø–∞–ø—Ü—ñ `dist/`.

### –†—ñ—à–µ–Ω–Ω—è (–∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º):

#### 1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ SSH:
```bash
ssh root@your-server-ip
```

#### 2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É –ø–∞–ø–∫—É –ø—Ä–æ—î–∫—Ç—É:
```bash
cd ~/affiliate-tracking
```

#### 3. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ API URL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω—É (–û–ë–û–í'–Ø–ó–ö–û–í–û!):

**–°—Ç–≤–æ—Ä—ñ—Ç—å –∞–±–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —Ñ–∞–π–ª `frontend/.env`:**
```bash
cd frontend
nano .env
```

**–î–æ–¥–∞–π—Ç–µ —Ä—è–¥–æ–∫ (–∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à –ø—Ä–æ–¥–∞–∫—à–Ω-URL):**
```env
VITE_API_URL=https://lehko.space
```

**‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:** 
- –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `http://localhost:3000` –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω—ñ!
- –Ø–∫—â–æ –≤–∞—à —Å–∞–π—Ç –Ω–∞ HTTPS, API URL —Ç–µ–∂ –º–∞—î –±—É—Ç–∏ HTTPS
- –ü—Ä–∏–∫–ª–∞–¥: `https://lehko.space` –∞–±–æ `https://api.yourdomain.com`

**–ó–±–µ—Ä–µ–∂—ñ—Ç—å:** `Ctrl+O` ‚Üí Enter ‚Üí `Ctrl+X`

#### 4. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–±–µ—Ä—ñ—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:
```bash
npm install
npm run build
```

**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç–≤–æ—Ä–µ–Ω–∞ –ø–∞–ø–∫–∞ `dist/` –∑ —Ñ–∞–π–ª–∞–º–∏ `index.html` —Ç–∞ `assets/`

#### 5. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –≤–∫–∞–∑—É—î –Ω–∞ `frontend/dist/`:
```bash
# –î–ª—è nginx –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é:
sudo nginx -t
sudo systemctl reload nginx
```

#### 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å backend:
```bash
cd ~/affiliate-tracking
pm2 restart affiliate-tracking-api
```

#### 7. –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞:
- –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `Ctrl+Shift+R` (–∞–±–æ `Cmd+Shift+R` –Ω–∞ Mac) –¥–ª—è –∂–æ—Ä—Å—Ç–∫–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

### –®–≤–∏–¥–∫–∞ –∫–æ–º–∞–Ω–¥–∞ (–≤—Å–µ —Ä–∞–∑–æ–º):
```bash
cd ~/affiliate-tracking/frontend
# –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ .env –º—ñ—Å—Ç–∏—Ç—å VITE_API_URL=https://your-api-domain.com
npm install && npm run build
cd .. && pm2 restart affiliate-tracking-api
```

---

## GTM: –ø–æ–¥–≤—ñ–π–Ω—ñ –ª—ñ–¥–∏ (—Ä–∞—Ö—É—î 1 –∫–ª—ñ–∫ —è–∫ 2 –ª—ñ–¥–∏ / –ø–æ–¥–≤—ñ–π–Ω–∏–π –¥–æ—Ö—ñ–¥)

**–°–∏–º–ø—Ç–æ–º:** –ó–∞–π—à–æ–≤ –ø–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—é –¥–≤—ñ—á—ñ, –¥–≤—ñ—á—ñ –∫—É–ø–∏–≤ ‚Äî —É —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ 4 –ª—ñ–¥–∏ –∑–∞–º—ñ—Å—Ç—å 2, –¥–æ—Ö—ñ–¥ –ø–æ–¥–≤–æ—î–Ω–∏–π.

**–ü—Ä–∏—á–∏–Ω–∞:** –£ GTM —î **–¥–≤–∞ –¥–∂–µ—Ä–µ–ª–∞** –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ª—ñ–¥–∞ –Ω–∞ –æ–¥–∏–Ω –∫–ª—ñ–∫:
1. –ü—ñ–∫—Å–µ–ª—å **pixel.js** ‚Äî –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ –∫–Ω–æ–ø—Ü—ñ ¬´–ö—É–ø–∏—Ç–∏¬ª / ¬´–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è¬ª —Å–∞–º –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –ª—ñ–¥.
2. –û–∫—Ä–µ–º–∏–π —Ç–µ–≥ —É GTM, —è–∫–∏–π —Å–ø—Ä–∞—Ü—å–æ–≤—É—î –Ω–∞ –∫–ª—ñ–∫ –ø–æ —Ç—ñ–π —Å–∞–º—ñ–π –∫–Ω–æ–ø—Ü—ñ —ñ –≤–∏–∫–ª–∏–∫–∞—î `window.lehkoTrack.trackLead()`.

**–©–æ –∑—Ä–æ–±–∏—Ç–∏:** –ó–∞–ª–∏—à–∏—Ç–∏ –≤ GTM **–ª–∏—à–µ –æ–¥–∏–Ω** —Ç–µ–≥ ‚Äî —Ç–æ–π, —â–æ –ø—ñ–¥–≤–∞–Ω—Ç–∞–∂—É—î **pixel.js** (–∑ `__lehkoConfig` —ñ —Ç—Ä–∏–≥–µ—Ä–æ–º All Pages). –¢–µ–≥ ¬´–ø—Ä–∏ –∫–ª—ñ–∫—É ‚Üí trackLead()¬ª –≤–∏–¥–∞–ª–∏—Ç–∏ –∞–±–æ –Ω–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏.

**–î–æ–¥–∞—Ç–∫–æ–≤–æ:** –£ –∫–æ–¥—ñ –∑–º—ñ–Ω–µ–Ω–æ –¥–µ–¥—É–ø–ª—ñ–∫–∞—Ü—ñ—é: –ª—ñ–¥ –±–µ–∑ order_id –Ω–µ –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è –¥–≤—ñ—á—ñ –ø—Ä–æ—Ç—è–≥–æ–º 12 —Å (–∫–ª—ñ—î–Ω—Ç) —ñ 15 —Å (—Å–µ—Ä–≤–µ—Ä), —Ç–æ–º—É –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –ø–æ–¥–≤—ñ–π–Ω–æ–º—É –≤–∏–∫–ª–∏–∫—É –¥—Ä—É–≥–∏–π –∑–∞–ø–∏—Ç –±—É–¥–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ.

---

## –õ—ñ–¥ –Ω–∞ ¬´–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è¬ª –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –¥–æ–¥–∞–≤–∞—Ç–∏ —Å—É–º—É (–¥–æ—Ö—ñ–¥ —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –ø–æ–∫—É–ø–∫–∏)

**–°–∏–º–ø—Ç–æ–º:** –ü—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ ¬´–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è¬ª –¥–æ–¥–∞—î—Ç—å—Å—è –ª—ñ–¥ —ñ –æ–¥—Ä–∞–∑—É –ø—Ä–∏–±–∞–≤–ª—è—î—Ç—å—Å—è —Å—É–º–∞ –ø–æ–∫—É–ø–∫–∏, —Ö–æ—á–∞ –æ–ø–ª–∞—Ç–∞ —â–µ –Ω–µ –ø—Ä–æ–π—à–ª–∞.

**–©–æ –∑—Ä–æ–±–ª–µ–Ω–æ:**
- **–ü—ñ–∫—Å–µ–ª—å:** –ü–æ–¥—ñ—è **lead** (–∫–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ –∫—É–ø—ñ–≤–ª—ñ/–æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è) —Ç–µ–ø–µ—Ä –∑–∞–≤–∂–¥–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∑ **order_value = 0**. –°—É–º–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ª–∏—à–µ –¥–ª—è –ø–æ–¥—ñ—ó **sale** (—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –ø–æ–¥—è–∫–∏ –∞–±–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∞ –æ–ø–ª–∞—Ç–∞).
- **–î–∞—à–±–æ—Ä–¥:** –ë–ª–æ–∫ ¬´–î–æ—Ö—ñ–¥¬ª –ø–æ–∫–∞–∑—É—î –ª–∏—à–µ **sales_revenue** (—Å—É–º–∞ –∑ –ø—Ä–æ–¥–∞–∂—ñ–≤), –±–µ–∑ –ø—ñ–¥—Å—É–º–æ–≤—É–≤–∞–Ω–Ω—è —Å—É–º –∑ –ª—ñ–¥–æ–≤. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ –≤ –±–∞–∑—ñ —É –ª—ñ–¥–∞ –±—É–ª–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ —Å—É–º—É (—Å—Ç–∞—Ä—ñ –∑–∞–ø–∏—Å–∏), —É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ –≤–æ–Ω–∞ –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è.

–ü—ñ–¥—Å—É–º–æ–∫: –ª—ñ–¥–∏ —Ä–∞—Ö—É—é—Ç—å—Å—è (–∫–ª—ñ–∫–∏ –ø–æ –∫–Ω–æ–ø—Ü—ñ), –∞ —Å—É–º–∞ –≤ ¬´–î–æ—Ö—ñ–¥¬ª –∑‚Äô—è–≤–ª—è—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è —Ä–µ–∞–ª—å–Ω–æ—ó –ø–æ–∫—É–ø–∫–∏ (sale).

---

## GTM: –ø–æ–º–∏–ª–∫–∞ net::ERR_BLOCKED_BY_ORB –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ pixel.js

**–°–∏–º–ø—Ç–æ–º:** –£ –∫–æ–Ω—Å–æ–ª—ñ/Network –±–∞—á–∏—Ç–µ `pixel.js (failed) net::ERR_BLOCKED_BY_ORB`. –¢—Ä–µ–∫–µ—Ä –∑ GTM –Ω–µ –ø—Ä–∞—Ü—é—î.

**–†—ñ—à–µ–Ω–Ω—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≥–æ—Ç–æ–≤–∏–π –∫–æ–Ω—Ñ—ñ–≥ nginx, –¥–µ `/pixel.js` —ñ `/api` –ø—Ä–æ–∫—Å—É—é—Ç—å—Å—è –Ω–∞ Node.

–£ –ø—Ä–æ—î–∫—Ç—ñ —î —Ñ–∞–π–ª **`nginx-lehko.space.conf.example`** ‚Äî –ø–æ–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É –¥–ª—è lehko.space. –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ:

```bash
# 1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∞–±–æ —Å–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç –≤—Ä—É—á–Ω—É), –ø–æ—Ç—ñ–º:
sudo cp /root/affiliate-tracking/nginx-lehko.space.conf.example /etc/nginx/sites-available/lehko.space

# 2. –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ —à–ª—è—Ö–∏ –¥–æ SSL —ñ –ø–æ—Ä—Ç Node (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 3000):
sudo nano /etc/nginx/sites-available/lehko.space

# 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
sudo nginx -t && sudo systemctl reload nginx
```

–£ –∫–æ–Ω—Ñ—ñ–≥—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ –ø—ñ–¥—Å—Ç–∞–≤–∏—Ç–∏ —Å–≤–æ—ó —à–ª—è—Ö–∏ –¥–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ Let's Encrypt: `fullchain.pem` —Ç–∞ `privkey.pem`). –†–µ—à—Ç–∞ –≤–∂–µ –≤—Ä–∞—Ö–æ–≤–∞–Ω–∞: pixel.js ‚Üí Node, /api —Ç–∞ /track ‚Üí Node, —Ñ—Ä–æ–Ω—Ç –∑ `/var/www/lehko.space`, SPA try_files.

---

## –©–æ–± —Ç—Ä–µ–∫–µ—Ä –ø—Ä–∞—Ü—é–≤–∞–≤ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥—É (—á–µ–∫–ª–∏—Å—Ç)

### –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ lehko.space (–≤–∞—à API/–±–µ–∫–µ–Ω–¥)

1. **Nginx –≤—ñ–¥–¥–∞—î pixel.js —ñ tracker.js –∑ –±–µ–∫–µ–Ω–¥—É (–Ω–µ HTML).**  
   –£ –∫–æ–Ω—Ñ—ñ–≥—É –º–∞—é—Ç—å –±—É—Ç–∏ –æ–∫—Ä–µ–º—ñ `location` –∑ `proxy_pass` –Ω–∞ Node (–ø–æ—Ä—Ç 3000):
   - `location = /pixel.js { proxy_pass http://127.0.0.1:3000; ... }`
   - `location = /tracker.js { proxy_pass http://127.0.0.1:3000; ... }`  
   –Ü–Ω–∞–∫—à–µ –±—Ä–∞—É–∑–µ—Ä –æ—Ç—Ä–∏–º–∞—î HTML (SPA) —ñ –∑‚Äô—è–≤–∏—Ç—å—Å—è **ERR_BLOCKED_BY_ORB**.

2. **Node (PM2) –∑–∞–ø—É—â–µ–Ω–∏–π** —ñ —Å–ª—É—Ö–∞—î —Ç–æ–π —Å–∞–º–∏–π –ø–æ—Ä—Ç, —â–æ –≤ nginx (`proxy_pass`).

3. **–ü—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É** –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å API:  
   `pm2 restart affiliate-tracking-api`

### –ù–∞ —Å–∞–π—Ç—ñ, –¥–µ —Å—Ç–∞–≤–∏—Ç–µ —Ç—Ä–µ–∫–µ—Ä (–∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π —Ö–æ—Å—Ç–∏–Ω–≥)

4. **–ü—ñ–¥–∫–ª—é—á–∞–π—Ç–µ –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç** ‚Äî –∞–±–æ **pixel.js** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ), –∞–±–æ tracker.js. –û–±–∏–¥–≤–∞ URL —Ç–µ–ø–µ—Ä –≤—ñ–¥–¥–∞—é—Ç—å –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π —Ç—Ä–µ–∫–µ—Ä. –ü–æ—Å–∏–ª–∞–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ **HTTPS**:  
   `https://lehko.space/pixel.js` (–∞–±–æ `https://lehko.space/tracker.js`).

5. **–Ø–∫—â–æ —Å—Ç–∞–≤–∏—Ç–µ —á–µ—Ä–µ–∑ GTM** ‚Äî —É Custom HTML —Ç–µ–≥—É –º–∞—î –±—É—Ç–∏:
   - `window.__lehkoConfig = { siteId: 'ID_–°–ê–ô–¢–£', baseUrl: 'https://lehko.space' };`
   - –ø–æ—Ç—ñ–º –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞: `https://lehko.space/pixel.js` –∑ `data-site="ID_–°–ê–ô–¢–£"`.  
   –¢—Ä–∏–≥–µ—Ä ‚Äî **All Pages**.  
   **–í–∞–∂–ª–∏–≤–æ:** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ª–∏—à–µ —Ü–µ–π –æ–¥–∏–Ω —Ç–µ–≥ (–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è pixel.js). –ù–µ –¥–æ–¥–∞–≤–∞–π—Ç–µ –æ–∫—Ä–µ–º–∏–π —Ç–µ–≥ —Ç–∏–ø—É ¬´–ø—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É –∫—É–ø—ñ–≤–ª—ñ ‚Üí –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `window.lehkoTrack.trackLead()`¬ª ‚Äî –ø—ñ–∫—Å–µ–ª—å —Å–∞–º –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –ª—ñ–¥ –ø–æ –∫–ª—ñ–∫—É; –ø–æ–¥–≤—ñ–π–Ω–∏–π —Ç–µ–≥ –¥–∞—Å—Ç—å –ø–æ–¥–≤—ñ–π–Ω—ñ –ª—ñ–¥–∏ —Ç–∞ –ø–æ–¥–≤—ñ–π–Ω–∏–π –¥–æ—Ö—ñ–¥.

6. **–ù–µ –±–ª–æ–∫—É–π—Ç–µ –¥–æ–º–µ–Ω —Ç—Ä–µ–∫–µ—Ä–∞**: —É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö —Ö–æ—Å—Ç–∏–Ω–≥—É / WAF / –±–æ—Ç-–∑–∞—Ö–∏—Å—Ç—ñ –Ω–µ –º–∞—î –±—É—Ç–∏ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ `lehko.space` –∑ –≤–∞—à–æ–≥–æ –¥–æ–º–µ–Ω—É. –°–ø–∏—Å–æ–∫ –±–æ—Ç—ñ–≤ (Yandex, Ahrefs —Ç–æ—â–æ) –Ω–∞ —Ü–µ –Ω–µ –≤–ø–ª–∏–≤–∞—î ‚Äî —Ç—Ä–µ–∫–µ—Ä –ø—Ä–∞—Ü—é—î –≤ –±—Ä–∞—É–∑–µ—Ä—ñ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á–∞.

7. **–Ø–∫—â–æ —î Content-Security-Policy (CSP)** ‚Äî —É –Ω—ñ–π –º–∞—î –±—É—Ç–∏ –¥–æ–∑–≤—ñ–ª –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∏ –∑ `https://lehko.space` (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `script-src ... https://lehko.space`).

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

8. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Å–∞–π—Ç –∑ —Ç—Ä–µ–∫–µ—Ä–æ–º ‚Üí DevTools ‚Üí **Network**. –ó–Ω–∞–π–¥—ñ—Ç—å –∑–∞–ø–∏—Ç –¥–æ `pixel.js` –∞–±–æ `tracker.js`: —Å—Ç–∞—Ç—É—Å –º–∞—î –±—É—Ç–∏ **200**, —Ç–∏–ø ‚Äî **script**. –Ø–∫—â–æ **failed** –∞–±–æ **ERR_BLOCKED_BY_ORB** ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—É–Ω–∫—Ç–∏ 1‚Äì2 —ñ 6‚Äì7.

9. –£ **Console** –ø—ñ—Å–ª—è –∫–ª—ñ–∫—É –ø–æ –∫–Ω–æ–ø—Ü—ñ –ø–æ–∫—É–ø–∫–∏/–æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –º–∞—é—Ç—å –∑‚Äô—è–≤–ª—è—Ç–∏—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∏–ø—É `[LehkoTrack] LEAD` –∞–±–æ `[LehkoTrack] SALE`.

---

## –ü–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞?

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏ –ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: `pm2 logs affiliate-tracking-api`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ–º–∏–ª–∫–∏: `pm2 logs affiliate-tracking-api --err`
3. –í—ñ–¥–∫–æ—Ç–∏—Ç–µ –∑–º—ñ–Ω–∏: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É –∫–æ–ø—ñ—é
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É: `https://your-domain.com/tracker-test.html`
