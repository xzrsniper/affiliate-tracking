# Чому конверсія не рахується та звідки береться ref

## Щоб конверсія зарахувалась

1. **Відвідувач має спочатку зайти на сайт через tracking-посилання.**  
   Приклад: `https://lehko.space/track/b0xIzk9C` → редірект на ваш сайт з параметром `?ref=b0xIzk9C`.  
   Тільки тоді трекер збереже `ref` у localStorage і зможе прив’язати конверсію до посилання.

2. **Не відкривати сайт напряму** (наприклад, просто `https://yoursite.com`).  
   Якщо користувач зайшов без `?ref=...`, код не збережеться і конверсія не прив’яжеться до афіліата.

3. **Перевірте, що ref дійсно є в URL після редіректу.**  
   Після кліку по tracking-посиланню у адресному рядку має бути щось на кшталт:  
   `https://yoursite.com/?ref=b0xIzk9C` або `https://yoursite.com/...?ref=b0xIzk9C`.  
   Якщо після оновлення сайту ref зникає — можливо, SPA або конфіг сервера скидають query-параметри; це треба виправити на стороні сайту.

4. **Трекер має бути встановлений на всіх сторінках**, зокрема на сторінці подяки/успіху (thank-you, success тощо).  
   Без трекера на цій сторінці конверсія не відправиться.

## Помилка "Cannot redefine property: ethereum"

Це **не помилка Lehko Track**. Її викликає розширення браузера (наприклад, гаманець evmAsk.js). Можна:

- ігнорувати її, або  
- вимкнути відповідне розширення на час перевірки трекера.

## Що змінено в проєкті

- **Setup «Мої сайти»** і **головна (Dashboard)** тепер використовують одну й ту саму перевірку: чи встановлено трекер на домені посилання (verification ping або перевірка HTML).  
  Якщо трекер виявлено на домені цільового URL посилання (наприклад, netlify), у головній більше не буде «Код не вставлено на сайт», коли в Setup показано «Підключено».

- Редірект з `/track/:code` як і раніше додає параметр `ref` до цільового URL; конверсія рахується, якщо відвідувач спочатку зайшов через це посилання.
