<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Оформлення замовлення — Shopin</title>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5VTN25N6');</script>
<!-- End Google Tag Manager -->
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VTN25N6"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #0f766e 0%, #0d9488 50%, #14b8a6 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 720px; margin: 0 auto; background: #fff; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); overflow: hidden; }
        header { background: linear-gradient(135deg, #0f766e 0%, #0d9488 100%); color: #fff; padding: 28px; text-align: center; }
        header h1 { font-size: 1.8em; }
        .content { padding: 32px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; color: #111; }
        input, textarea { width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1em; }
        input:focus, textarea:focus { outline: none; border-color: #0d9488; }
        .order-summary { background: #f0fdfa; padding: 20px; border-radius: 12px; margin-bottom: 24px; border: 1px solid #99f6e4; }
        .order-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #e5e7eb; }
        .order-item:last-child { border-bottom: none; }
        .total { margin-top: 12px; padding-top: 12px; border-top: 2px solid #0d9488; display: flex; justify-content: space-between; font-size: 1.2em; font-weight: 700; color: #0d9488; }
        .btn { width: 100%; padding: 14px; background: linear-gradient(135deg, #0f766e 0%, #0d9488 100%); color: #fff; border: none; border-radius: 8px; font-size: 1.1em; font-weight: 600; cursor: pointer; }
        .btn:hover { opacity: 0.95; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .back-link { display: inline-block; margin-bottom: 20px; color: #0d9488; text-decoration: none; font-weight: 600; }
        .back-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <header><h1>Оформлення замовлення</h1></header>
        <div class="content">
            <a href="index.html" class="back-link">← Назад до товарів</a>
            <div class="order-summary" id="orderSummary">
                <h3>Ваше замовлення</h3>
                <div id="orderItems"></div>
                <div class="total"><span>Всього:</span><span id="totalPrice">0 ₴</span></div>
            </div>
            <form id="checkoutForm">
                <div class="form-group">
                    <label for="name">Ім'я та прізвище *</label>
                    <input type="text" id="name" name="name" required placeholder="Іван Іванов">
                </div>
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" id="email" name="email" required placeholder="ivan@example.com">
                </div>
                <div class="form-group">
                    <label for="phone">Телефон *</label>
                    <input type="tel" id="phone" name="phone" required placeholder="+380501234567">
                </div>
                <div class="form-group">
                    <label for="address">Адреса доставки *</label>
                    <textarea id="address" name="address" rows="3" required placeholder="Місто, вулиця, будинок"></textarea>
                </div>
                <button type="submit" class="btn" id="submitBtn">Підтвердити замовлення</button>
            </form>
        </div>
    </div>
    <script>
        var cart = JSON.parse(localStorage.getItem('shopinCart')) || [];
        function renderOrder() {
            var orderItems = document.getElementById('orderItems');
            var totalPrice = document.getElementById('totalPrice');
            if (cart.length === 0) {
                orderItems.innerHTML = '<p>Кошик порожній.</p>';
                totalPrice.textContent = '0 ₴';
                document.getElementById('submitBtn').disabled = true;
                return;
            }
            var total = 0;
            orderItems.innerHTML = cart.map(function(item) {
                total += item.price;
                return '<div class="order-item"><span>' + item.name + '</span><span>' + item.price.toLocaleString('uk-UA') + ' ₴</span></div>';
            }).join('');
            totalPrice.textContent = total.toLocaleString('uk-UA') + ' ₴';
        }
        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var total = cart.reduce(function(sum, item) { return sum + item.price; }, 0);
            var orderId = 'SHOPIN-' + Date.now();
            var formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value,
                items: cart,
                total: total,
                orderId: orderId
            };
            localStorage.setItem('shopinOrder', JSON.stringify(formData));
            localStorage.removeItem('shopinCart');
            var ref = localStorage.getItem('aff_ref_code') || '';
            var thankYouUrl = 'thank-you.html?order=' + encodeURIComponent(orderId) + '&total=' + total;
            if (ref) thankYouUrl += '&ref=' + encodeURIComponent(ref);
            window.location.href = thankYouUrl;
        });
        renderOrder();
    </script>
</body>
</html>
